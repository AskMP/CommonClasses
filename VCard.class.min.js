const FIELDS=[{name:"ADR",attribute:"address",match:/(ADR;?)(TYPE=[\w|\s|\d]*)?/i,process:t=>t.split(";").map(t=>t.trim()).filter(t=>""!==t)},{name:"ANNIVERSARY",attribute:"anniversary",match:/(ANNIVERSARY)/i,process:t=>[t.substr(0,4),t.substr(3,2),t.substr(5,2)].join("-")},{name:"BDAY",attribute:"birthday",match:/(BDAY)/i,process:t=>[t.substr(0,4),t.substr(3,2),t.substr(5,2)].join("-")},{name:"CATEGORIES",attribute:"categories",match:/(CATEGORIES)/i,process:t=>t.split(",").map(t=>t.trim()).filter(t=>""!==t)},{name:"EMAIL",attribute:"email",match:/(EMAIL)/i,process:t=>t.trim()},{name:"FN",attribute:"fullname",match:/(FN)/i,process:t=>t.trim()},{name:"GENDER",attribute:"gender",match:/(GENDER)/i,process:t=>t.trim()},{name:"GEO",attribute:"geographical",match:/(GEO)/i,process:t=>t.replace(/(geo\:)/gi,"").replace(";",",").split(",").map(t=>parseFloat(t))},{name:"LANG",attribute:"language",match:/(LANG)/i,process:t=>t.trim()},{name:"N",attribute:"name",match:/(N)/i,process:t=>Object.fromEntries(t.split(";").map((t,e)=>{switch(e){case 0:return["family",t];case 1:return["given",t];case 2:return["middle",t];case 3:return["suffix",t]}}))},{name:"NOTE",attribute:"notes",match:/(NOTES)/i,process:t=>t.trim().replace(/\\n/,"\r\n")},{name:"ORG",attribute:"organizations",match:/(ORG)/i,process:t=>t.split(";")},{name:"ROLE",attribute:"role",match:/(ROLE)/i,process:t=>t.trim()},{name:"TEL",attribute:"phone",match:/(TEL;?)(TYPE=[\w|\s|\d]*)?/i,process:t=>parseInt(t.replace(/\D/gi,""),10)},{name:"TITLE",attribute:"title",match:/(TITLE)/i,process:t=>t.trim()},{name:"TZ",attribute:"timezone",match:/(TZ)/i,process:t=>t.trim()},{name:"URL",attribute:"website",match:/(URL)/i,process:t=>t.trim()}];export class VCard{constructor(t=!1){t&&this.parse(t)}parse(t=""){if("ArrayBuffer"===t.constructor.name&&(t=String.fromCharCode.apply(null,new Uint8Array(t))),"String"!==t.constructor.name)throw new Error("Invalid data type to parse. Must be a string");if(this.raw=t,(t=t.split("\n")).forEach(t=>{let e=(t=t.split(":")).shift();t=t.join(":"),FIELDS.forEach(a=>{0!==e.search(a.match)||1===a.name.length&&1!==e.length||(this[a.attribute]&&"Array"!==this[a.attribute].constructor.name?this[a.attribute]=[this[a.attribute]].concat(a.process(t)):this[a.attribute]=a.process(t))})}),this.fullname){let t=this.fullname.split(" ");this.name={given:t[0],family:t.length>2?t[2]:t[1],middle:t.length>2?t[1]:void 0}}else""===this.fullname&&this.name&&(this.fullname=`${name.given} ${name.middle} ${name.family}`.trim().replace(/\s\s/gi," "));return this}}export{VCard as default};